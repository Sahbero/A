<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Halka Oyun</title>
  <style>
    canvas {
      background: #111;
      display: block;
      margin: auto;
    }
    #barrierButton {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: #222;
      border: none;
      cursor: pointer;
      outline: none;
      color: white;
      font-weight: bold;
      font-size: 14px;
      z-index: 2;
    }
    #barrierRing {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      box-sizing: border-box;
      pointer-events: none;
      z-index: 1;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="barrierRing"></div>
  <button id="barrierButton">B</button>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const barrierButton = document.getElementById("barrierButton");
    const barrierRing = document.getElementById("barrierRing");

    let barrierReady = false;
    let barrierActive = false;
    let barrierCooldown = 5000; 
    let barrierDuration = 3000; 
    let barrierTimer = 0;
    let barrierCooldownTimer = barrierCooldown;

    let lastTime = 0;

    // Bariyer çizim fonksiyonu
    function drawBarrier() {
      if (barrierActive) {
        ctx.beginPath();
        ctx.arc(400, 300, 100, 0, Math.PI * 2);
        ctx.strokeStyle = "white";
        ctx.shadowBlur = 20;
        ctx.shadowColor = "white";
        ctx.lineWidth = 6;
        ctx.stroke();
        ctx.shadowBlur = 0;
      } else if (!barrierReady) {
        ctx.beginPath();
        ctx.setLineDash([10, 10]);
        ctx.arc(400, 300, 100, 0, Math.PI * 2);
        ctx.strokeStyle = "gray";
        ctx.lineWidth = 3;
        ctx.stroke();
        ctx.setLineDash([]);
      }
    }

    // Bariyer UI halkası
    function updateBarrierRing() {
      if (barrierActive) {
        const progress = barrierTimer / barrierDuration;
        barrierRing.style.border = "4px solid green";
        barrierRing.style.background = `conic-gradient(green ${progress * 360}deg, transparent 0deg)`;
      } else if (barrierReady) {
        barrierRing.style.border = "4px solid green";
        barrierRing.style.background = "none";
      } else {
        barrierRing.style.border = "4px solid red";
        barrierRing.style.background = "none";
      }
    }

    barrierButton.addEventListener("click", () => {
      if (barrierReady) {
        barrierActive = true;
        barrierReady = false;
        barrierTimer = barrierDuration;
        barrierCooldownTimer = barrierCooldown;
      }
    });

    function update(deltaTime) {
      if (barrierActive) {
        barrierTimer -= deltaTime;
        if (barrierTimer <= 0) {
          barrierActive = false;
          barrierTimer = 0;
        }
      } else {
        if (barrierCooldownTimer > 0) {
          barrierCooldownTimer -= deltaTime;
          if (barrierCooldownTimer <= 0) {
            barrierReady = true;
          }
        }
      }
      updateBarrierRing();
    }

    function gameLoop(timestamp) {
      const deltaTime = timestamp - lastTime;
      lastTime = timestamp;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Oyun öğeleri korunuyor
      drawBarrier();

      update(deltaTime);
      requestAnimationFrame(gameLoop);
    }

    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
